<!DOCTYPE html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta th:replace="fragments/general.html :: head('Event')"/>

	<link rel="stylesheet"
	      href="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/build/css/tempusdominus-bootstrap-4.min.css"
	      integrity="sha256-VL9T9QfjO/EGCzuu5CtTWWzIksAkGDTs+fO51ALqMjg=" crossorigin="anonymous">
	<link rel="stylesheet" th:href="@{/assets/3rd/bootstrap3-editable/css/bootstrap-editable.css}">
	<link rel="stylesheet" th:href="@{/assets/css/sizes.css}">
	<link rel="stylesheet" th:href="@{/assets/css/positions.css}">
	<link rel="stylesheet" th:href="@{/assets/css/buttons.css}">
	<link rel="stylesheet" th:href="@{/assets/css/editable.css}">
	<link rel="stylesheet" th:href="@{/assets/css/events.css}">
</head>
<body>
<nav th:replace="fragments/navbar.html :: calendarSubPage"></nav>

<section class="content-section">
	<div class="container">
		<div>
			<a class="font-s" th:href="${eventDetailsUrl}">
				<em class="fas fa-chevron-circle-left"></em> Zurück
			</a>
		</div>

		<h3>Allgemeine Informationen</h3>
		<form>
			<div class="form-row">
				<div class="form-group col-md-11">
					<label for="eventName">Titel</label>
					<a id="eventName" class="form-control" href="#"></a>
				</div>
				<div class="form-group col-md-1">
					<div id="eventHidden" class="btn btn-xl btn-wht fa-pull-right" title="Sichtbarkeit">
						<em class="far" th:classappend="${event.hidden} ? 'fa-eye-slash' : 'fa-eye'"></em>
					</div>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label for="eventDate">Datum</label>
					<div id="datepicker" class="input-group date" data-target-input="nearest">
						<input id="eventDate" class="form-control datetimepicker-input" type="text"
						       data-dtokey="date" data-target="#datepicker" required th:value="${event.date}">
						<div class="input-group-append" data-target="#datepicker"
						     data-toggle="datetimepicker">
							<div class="input-group-text"><em class="far fa-calendar-alt"></em></div>
						</div>
					</div>
				</div>
				<div class="form-group col-md-4">
					<label for="eventStartTime">Startzeit</label>
					<div id="datetime" class="input-group date" data-target-input="nearest">
						<input id="eventStartTime" class="form-control datetimepicker-input" type="text"
						       data-dtokey="startTime" data-target="#datetime" required th:value="${event.startTime}">
						<div class="input-group-append" data-target="#datetime"
						     data-toggle="datetimepicker">
							<div class="input-group-text"><em class="far fa-clock"></em></div>
						</div>
					</div>
				</div>
				<div class="form-group col-md-4">
					<label for="eventCreator">Ersteller</label>
					<a id="eventCreator" class="form-control" href="#"></a>
				</div>
			</div>
			<div class="form-group">
				<label for="eventDescription">Beschreibung</label>
				<textarea id="eventDescription" class="form-control"></textarea>
			</div>
			<div class="form-row align-items-center">
				<div class="form-group col-md-2">
					<label for="eventMissionType">Missionstyp</label>
					<select id="eventMissionType" class="form-control custom-select" data-dtokey="missionType"
					        th:with="missionTypeEmpty=${#strings.isEmpty(event.missionType)}">
						<option th:text="${missionTypeEmpty} ? 'Auswählen...' : ${event.missionType}"
						        selected
						        th:disabled="${missionTypeEmpty}">
							Auswählen...
						</option>
						<option th:each="missionType : ${event.getMissionTypesFiltered()}"
						        th:text="${missionType}"></option>
					</select>
				</div>
				<div class="col-md-2">
					<div class="custom-control custom-checkbox mr-sm-2">
						<input id="eventRespawn" class="custom-control-input" type="checkbox"
						       data-dtokey="respawn" th:checked="${event.respawn}">
						<label class="custom-control-label" for="eventRespawn">Respawn</label>
					</div>
				</div>
				<div class="form-group col-md-4">
					<label for="eventMissionLength">Missionslänge</label>
					<a id="eventMissionLength" class="form-control custom-select" href="#"></a>
					<datalist id="missionLengths">
						<option>2 Stunden</option>
						<option>3 Stunden</option>
						<option>über 4 Stunden</option>
					</datalist>
				</div>
				<div class="form-group col-md-4">
					<label for="eventModPack">Modpack</label>
					<a id="eventModPack" class="form-control custom-select" href="#"></a>
					<datalist id="modPacks">
						<option th:each="modPack : ${event.getModPacksFiltered()}"
						        th:text="${modPack}"></option>
					</datalist>
				</div>
			</div>
		</form>

		<hr class="solid bg-light">

		<h3>Details</h3>
		<form>
			<div class="form-row mb-4">
				<div class="form-group col-md-4">
					<label for="eventMap">Karte</label>
					<select id="eventMap" class="form-control custom-select" data-dtokey="map">
						<option th:with="mapEmpty=${#strings.isEmpty(event.map)}"
						        th:text="${mapEmpty} ? 'Auswählen...' : ${event.map}" selected
						        th:disabled="${mapEmpty}">
							Auswählen...
						</option>
						<option th:each="map : ${event.getMapsFiltered()}" th:text="${map}"></option>
					</select>
				</div>
				<div class="form-group col-md-4">
					<label for="eventTechnicalTeleport">Technischer Teleport</label>
					<a id="eventTechnicalTeleport" class="form-control" href="#"></a>
				</div>
				<div class="form-group col-md-4">
					<label for="eventMedicalSystem">Medic-System</label>
					<a id="eventMedicalSystem" class="form-control" href="#"></a>
				</div>
			</div>
			<div class="form-row align-items-center mb-4">
				<div class="form-group col-md-4">
					<div class="custom-control custom-checkbox">
						<input id="eventReserveParticipating" class="custom-control-input" type="checkbox"
						       data-dtokey="reserveParticipating" th:checked="${event.reserveParticipating}">
						<label for="eventReserveParticipating" class="custom-control-label">
							Darf die Reserve mitspielen?
						</label>
					</div>
				</div>
				<div class="form-group col-md-4">
					<label for="eventMissionTime">Missionszeit</label>
					<a id="eventMissionTime" class="form-control" href="#"></a>
				</div>
				<div class="form-group col-md-4">
					<label for="eventNavigation">Navigation</label>
					<a id="eventNavigation" class="form-control" href="#"></a>
				</div>
			</div>
			<div class="form-row">
				<div class="col-md-4"></div>
				<div class="form-group col-md-8">
					<label for="eventPicture">
						Bild-URL
					</label>
					<a id="eventPicture" class="form-control" href="#"></a>
				</div>
			</div>
		</form>

		<hr class="solid bg-light">

		<div class="row">
			<div class="col-md-9">
				<h3>Teilnahmeplatzaufzählung</h3>
			</div>
			<div class="col-md-3">
				<div id="renumber" class="btn btn-secondary float-right" type="button">Neu nummerieren</div>
			</div>
		</div>
		<form>
			<div id="squads" class="js-sortable">
				<div class="form-group js-complete-squad" th:each="squad : ${event.squadList}"
				     th:data-squadid="${squad.id}">
					<div class="form-row align-items-center js-squad">
						<div><em class="fas fa-arrows-alt-v"></em></div>
						<div class="col-md-11">
							<!--suppress HtmlFormInputWithoutLabel -->
							<input class="form-control js-squad-name" type="text" placeholder="Squad Name"
							       required th:value="${squad.name}">
						</div>
						<div th:unless="${squad.isNotEmpty()}" class="d-flex btn btn-xl btn-wht js-trash" type="button">
							<em class="far fa-trash-alt"></em>
						</div>
						<div th:if="${squad.isNotEmpty()}" class="d-flex btn btn-xl btn-denied" title="Squad enthält nicht leere Slots">
							<em class="far fa-trash-alt"></em>
						</div>
					</div>

					<div class="ml-5 js-slots">
						<div class="form-row align-items-center js-slot" th:each="slot : ${squad.slotList}"
						     th:data-slotid="${slot.id}">
							<div class="col-md-1">
								<!--suppress HtmlFormInputWithoutLabel -->
								<input class="form-control js-slot-number" type="number" min="1" value="1"
								       required th:value="${slot.number}">
							</div>
							<div class="col-md-10">
								<!--suppress HtmlFormInputWithoutLabel -->
								<input class="form-control js-slot-name" type="text" placeholder="Slot Name"
								       required th:value="${slot.name}">
							</div>
							<div th:unless="${slot.isOccupied()}" class="col-md-1 d-flex btn btn-xl btn-wht js-trash" type="button">
								<em class="far fa-trash-alt"></em>
							</div>
							<div th:if="${slot.isOccupied()}" class="col-md-1 d-flex btn btn-xl btn-denied" title="Dieser Slot ist belegt">
								<em class="far fa-trash-alt"></em>
							</div>
						</div>
						<div type="button" class="btn btn-success rounded-circle js-add-slot"
						     title="Slot hinzufügen">
							<em class="fas fa-plus"></em>
						</div>
					</div>
				</div>

				<div id="addSquad" type="button" class="btn btn-success rounded-circle"
				     title="Squad hinzufügen">
					<em class="fas fa-plus"></em>
				</div>
			</div>

			<div id="uniqueSlotNumbersError" class="alert alert-danger" role="alert" style="display: none">
				Slotnummern müssen eindeutig sein. Bitte korrigieren.
			</div>
		</form>
		<div class="row float-right">
			<button id="btnSaveSlotlist" class="btn btn-primary" tabindex="0" data-toggle="popover"
			        data-trigger="focus" data-content="Alle Pflichfelder ausfüllen!">
				Slotliste speichern
			</button>
		</div>
	</div>
</section>

<footer th:insert="fragments/general.html :: footer"></footer>

<div class="position-relative" aria-live="polite" aria-atomic="true">
	<div id="savedToast" class="toast bottom-right" data-delay="2000">
		<div class="toast-header">
			<span class="rounded mr-2 square-em-1 bg-success"></span>
			<strong class="mr-auto">Änderungen gespeichert</strong>
			<button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
	</div>
</div>

<div class="position-relative" aria-live="polite" aria-atomic="true">
	<div id="errorToast" class="toast bottom-right" data-delay="5000">
		<div class="toast-header">
			<span class="rounded mr-2 square-em-1 bg-danger"></span>
			<strong class="mr-auto">Fehler aufgetreten</strong>
			<button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
	</div>
</div>

<script th:replace="fragments/scripts.html :: jqueryANDpopperANDbootstrap"></script>
<script th:replace="fragments/scripts.html :: jqueryuiANDmomentANDtempusdominus"></script>
<script th:replace="fragments/scripts.html :: xeditable"></script>
<script th:inline="javascript">
	/*<![CDATA[*/
	const eventsUrl = /*[[${eventsUrl}]]*/ '';
	const putEventUrl = /*[[${putEventUrl}]]*/ '';
	const putEventEditableUrl = /*[[${putEventEditableUrl}]]*/ '';
	const eventDetailsUrl = /*[[${eventDetailsUrl}]]*/ '';
	const savedEvent = /*[[${event}]]*/ '';
	/*]]>*/
</script>
<script th:src="@{/assets/js/datetimepicker.js}"></script>
<script th:src="@{/assets/js/eventSave.js}"></script>
<script th:src="@{/assets/js/slotList.js}"></script>
<script th:src="@{/assets/js/eventEdit.js}"></script>
</body>
</html>